apiVersion: v1
kind: ConfigMap
metadata:
  name: prism-config
  namespace: prism
  labels:
    app.kubernetes.io/name: prism
    app.kubernetes.io/component: proxy
data:
  prism.yaml: |
    # Prism Configuration
    listeners:
      - address: "0.0.0.0:8080"
        protocol: http

    upstreams:
      backend:
        servers:
          - address: "backend-service:80"
            weight: 1
        load_balancing:
          algorithm: round_robin
        health_check:
          enabled: true
          interval: 10s
          timeout: 5s
          path: /health
          healthy_threshold: 2
          unhealthy_threshold: 3

    routes:
      - match:
          path_prefix: "/"
        upstream: backend

    observability:
      metrics:
        enabled: true
        address: "0.0.0.0:9090"
        path: /metrics
      logging:
        level: info
        format: json
      tracing:
        enabled: false

    admin:
      enabled: true
      address: "0.0.0.0:9090"
